/*! For license information please see AutocompleteConcierge-704e81143f8dee95e9b8.js.LICENSE.txt */
(self.webpackChunktemplate_stencils=self.webpackChunktemplate_stencils||[]).push([[641],{38630:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var o=r(67294),n=r(45697),a=r.n(n),s=r(27354),c=r(35733);class l{constructor(e){if(!e||0===e.length)throw new Error("At least one adapter is required for AutocompleteService");this.autocompleteAdapters=[],Array.from(e).forEach((e=>{if(!e||!e.hasOwnProperty("autocomplete"))throw new Error(`${e.constructor.name} is not implemented yet`);this.registerAdapter(e)}))}registerAdapter(e){this.autocompleteAdapters.push(e)}getResults(e,t){return Promise.all(this.autocompleteAdapters.map((r=>r.getResults(e,t).then((e=>e.json()))))).then((e=>{const t=[];let r=0,o=0;return e.map(((e,n)=>(r+=e.length,t[n]=[],e.length&&e.forEach((e=>{t[n][o++]=e})),t))),{results:t,count:r}})).catch((e=>(console.error(e),{results:[],count:0,error:e})))}}var i=r(29439),u=r(97999),m=r(79963);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},d.apply(this,arguments)}function p(e){let{fetching:t,onSubmit:r,componentId:n}=e;return t?o.createElement("div",{className:"autocomplete-concierge__loader","aria-hidden":"true"},o.createElement("svg",{className:"autocomplete-concierge__icon",role:"img",focusable:!1},o.createElement("use",{href:"#spinner"}))):o.createElement("button",{type:"submit",className:"autocomplete-concierge__submit",onClick:r,"aria-labelledby":`${n}-submit-label`},o.createElement("svg",{className:"autocomplete-concierge__icon",role:"img",focusable:!1},o.createElement("title",{id:`${n}-submit-label`},"Submit search"),o.createElement("use",{href:"#search"})))}function f(e){const{id:t,templates:n,placeholder:a,debounce:l,action:u,method:f,hiddenFields:h,inputAttributes:v,showSubmit:E,onClose:b,showClear:y,showLoader:g}=e,{setSelectedIndex:_,selectedIndex:C,count:w,fetchResults:N,fetching:k}=(0,i.o)(),[S,P]=(0,o.useState)(null),[O,x]=(0,o.useState)(null),[j,T]=(0,o.useState)(null),[I,A]=(0,o.useState)(""),[R,$]=(0,o.useState)(""),[L,D]=(0,o.useState)(!1),[U,q]=(0,o.useState)("autocomplete-concierge__results"),M=(0,o.useRef)(),F=(0,o.useRef)(),W=(0,o.useRef)(null),Z=(0,m.uY)(),[K,Y]=(0,m.S5)(),{keyboardProps:B}=(0,s.v5)({onKeyUp:e=>{let t=-1;if(27===e.keyCode)return D(!1),_(-1),j||b(),void(W.current&&W.current.focus());if(40===e.keyCode&&(t=C+1>=w?0:C+1,K[t]&&K[t].scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})),38===e.keyCode&&(t=C-1<0?w-1:C-1,K[t]&&K[t].scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})),13===e.keyCode){if(-1===C)return void x(!0);K[C].click()}_(t),P(t),D(!0)},onKeyDown:e=>(40===e.keyCode||38===e.keyCode||13===e.keyCode||27===e.keyCode?e.preventDefault():W.current.focus(),!1)}),{focusWithinProps:Q}=(0,s.L_)({onFocusWithin:()=>{D(!0)},onBlurWithin:()=>{D(!1)}});(0,o.useEffect)((()=>{T((()=>L&&w>0))}),[w,L]),(0,o.useEffect)((()=>{const e=["autocomplete-concierge__results"];k&&j&&(e.push("autocomplete-concierge__results--expanding"),q(e.join(" "))),!k&&j&&(e.push("autocomplete-concierge__results--open"),q(e.join(" "))),k||j||(e.push("autocomplete-concierge__results--collapsing"),q(e.join(" ")))}),[j]),(0,o.useEffect)((()=>{const e=(0,m.jS)(document.location.href,"query");A(e||"")}),[]),(0,o.useEffect)((()=>{if(!I)return;$(w>0?`${w} results for ${I}`:`No results found for ${I}`)}),[w,I]),(0,o.useEffect)((()=>{const e=setTimeout((async()=>{""===I&&W.current.focus(),await N(I,n)}),l);return()=>clearTimeout(e)}),[I]),(0,o.useEffect)((()=>{if(O&&M.current&&W.current){if(W.current.value=I,Z){const e={TYPE:"SUBMIT",title:"NEEDS_REFRESH",url:window.location.href,time:Date.now()};return void Z.trackedEventWithCb(e,M.current.submit())}M.current.submit()}}),[O]);const V=(e,t,r)=>{if(Z){const o={TYPE:"CLICK",url:e,query:I,title:t};Z.trackedEventWithCb(o,r)}r&&!Z&&r()},z=(0,o.useCallback)(((e,t)=>{e.preventDefault();const{action:r,action_t:o,title:n}=t;if("Q"===o||void 0===o)return A(r||t),void x(!0);V(r,n,(()=>document.location.href=r))}),[]);return o.createElement("div",d({className:"autocomplete-concierge no-wysiwyg",role:"search"},Q),o.createElement("form",{ref:M,action:u,method:f,className:"autocomplete-concierge__form"},o.createElement("label",{className:"sr-only","aria-live":"polite",id:`${t}-label`},R),g&&o.createElement(p,{fetching:k,onSubmit:()=>x(!0),componentId:t}),o.createElement("input",d({id:`${t}-inputField`,ref:W,type:"text",autoComplete:"off",role:"combobox","aria-expanded":j,"aria-haspopup":"grid","aria-labelledby":`${t}-label`,"aria-autocomplete":"list","aria-controls":`${t}-grid`,"aria-activedescendant":-1===S?void 0:S,onChange:e=>{let{currentTarget:{value:t}}=e;A(t)},value:I,placeholder:a,className:"autocomplete-concierge__input",name:"query"},B,v)),h&&h.map((e=>o.createElement("input",{key:e.id,type:"hidden",name:e.name,value:e.value}))),o.createElement("button",{type:"button",className:["autocomplete-concierge__submit",!y||y&&0===I.length?"hidden":""].join(" "),onClick:()=>A(""),onKeyUp:e=>{e.preventDefault(),13===e.keyCode&&A("")}},o.createElement("svg",{className:"autocomplete-concierge__icon",role:"img",focusable:!1},o.createElement("title",null,"Clear search"),o.createElement("use",{href:"#close"})),"Clear"),E&&!g&&o.createElement("button",{type:"submit",className:"autocomplete-concierge__submit",onClick:()=>x(!0),"aria-labelledby":`${t}-submit-label`},o.createElement("svg",{className:"autocomplete-concierge__icon",role:"img",focusable:!1},o.createElement("title",{id:`${t}-submit-label`},"Submit search"),o.createElement("use",{href:"#search"})))),o.createElement("div",d({ref:F,role:"grid","aria-labelledby":`${t}-label`,"aria-hidden":!j,id:`${t}-grid`,className:U,tabIndex:-1},B,{style:{display:j?"":"none"}}),n&&n.map(((e,t)=>function(e){const{template:t}=e,n=(0,o.useMemo)((()=>(0,o.lazy)((()=>r(42276)(`./${t}`)))),[]);return o.createElement(o.Suspense,{key:`component-${t}`,fallback:o.createElement("span",{className:"sr-only"},"Loading template...")},o.createElement(n,e))}({...e,templateId:t,handleClick:z,trackedClick:V,childRefs:Y})))),o.createElement(c.U4,{onDismiss:()=>T(!1)}))}function h(e){const{adapters:t}=e,r=new l(t);return o.createElement(i.Z,{initialState:u.E3,reducer:u.ZP,autocompleteService:r},o.createElement(f,e))}const{string:v,arrayOf:E,shape:b,number:y,bool:g,func:_}=a();h.propTypes={id:v,templates:E(b({id:v,label:v,template:v,serviceUrl:v,params:v})).isRequired,placeholder:v,debounce:y,action:v,method:v,showSubmit:g,isOpen:g,onClose:_,showClear:g,showLoader:g},h.defaultProps={id:"autocomplete-search",placeholder:"Start your search here...",debounce:500,action:"search.html",method:"GET",showSubmit:!0,isOpen:!1,onClose:()=>{},showClear:!1,showLoader:!1}},25699:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var o=r(67294),n=r(86871),a=r(56078),s=r(35733),c=r(6365),l=r(49641);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},i.apply(this,arguments)}function u(e){let{titleId:t,title:r,onClose:n,children:a,className:c}=e;return o.createElement(s.Xj,null,o.createElement("div",{className:"no-wysiwyg modal-wrapper "+(c?`${c}-wrapper`:"")},o.createElement(l.MT,{contain:!0,restoreFocus:!0,autoFocus:!0},o.createElement(m,{titleId:t,title:r,onClose:n,className:c},a))))}function m(e){let{titleId:t,title:r,onClose:n,children:a,className:u}=e;const m={"aria-describedby":t,title:r,onClose:n,isDismissable:!0,isOpen:!0},d=o.useRef(),p=o.useRef(),f=(0,l.bO)(),{overlayProps:h,underlayProps:v}=(0,s.Ir)(m,p);(0,s.tk)();const{modalProps:E}=(0,s.dd)(),{dialogProps:b,titleProps:y}=(0,c.R)(m,p);return(0,o.useEffect)((()=>{d.current.removeAttribute("hidden"),f.focusFirst()}),[d]),o.createElement("div",i({ref:d},v,{hidden:!0,className:`modal ${u||""}`}),o.createElement("div",i({ref:p},h,b,E,{"aria-modal":"true",tabIndex:"-1",className:"modal__content "+(u?`${u}__content`:"")}),t?"":o.createElement("h2",i({},y,{className:""+(u?`${u}__title`:"")}),r),a))}var d=r(38630);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},p.apply(this,arguments)}function f(e){const[t,r]=(0,o.useState)(!1),c=(0,o.useCallback)((()=>{r(!1)}),[]);(0,a.j)();const l=(0,n.Z)(),{adapters:i}=e;return o.createElement(s.N3,{className:"no-wysiwyg autocomplete-wrapper"},o.createElement("button",{type:"button",className:"autocomplete-wrapper__action",onClick:()=>r(!t)},o.createElement("svg",{className:"autocomplete-wrapper__icon"},o.createElement("title",null,"Search"),o.createElement("use",{href:"#search"}))),t&&o.createElement(u,{titleId:l,className:"autocomplete-modal",onClose:c},o.createElement("header",{className:"autocomplete-modal__header"},o.createElement("button",{type:"button",onClick:c,className:"autocomplete-modal__header-close"},o.createElement("svg",{className:"autocomplete-modal__icon"},o.createElement("title",null,"Close modal"),o.createElement("use",{href:"#close"})))),o.createElement("div",{className:"autocomplete-modal__body"},o.createElement(d.default,p({},e,{adapters:i,onClose:c})))))}},29439:function(e,t,r){"use strict";r.d(t,{o:function(){return s}});var o=r(67294),n=r(97999);const a=(0,o.createContext)();a.displayName="PNP-STORE";const s=()=>(0,o.useContext)(a);t.Z=function(e){let{children:t,initialState:r,reducer:s,autocompleteService:c}=e;const[l,i]=(0,o.useReducer)(s,r),u=(0,o.useMemo)((()=>(0,n.Ix)(i,c)),[]),m=(0,o.useMemo)((()=>({...u,dispatch:i,...l})));return o.createElement(a.Provider,{value:m},t)}},97999:function(e,t,r){"use strict";r.d(t,{E3:function(){return l},Ix:function(){return i}});const o="PNP/AUTOCOMPLETE/UPDATE_RESULTS",n="PNP/AUTOCOMPLETE/SET_SELECTED",a="PNP/AUTOCOMPLETE/LOAD_REQUEST",s="PNP/AUTOCOMPLETE/LOAD_FAILED",c="PNP/AUTOCOMPLETE/LOAD_SUCCESS",l={results:[],count:0,query:"",selectedIndex:-1,fetching:!1,error:""},i=(e,t)=>({updateResults:(t,r)=>{e({type:o,results:t,count:r})},setSelectedIndex:t=>{e({type:n,selectedIndex:t})},fetchResults:async r=>{if(!r)return void e({type:o,results:[],count:0});e({type:a});const{results:n,count:l,error:i}=await t.getResults(r);if(i)return console.error("There was an error fetching results from the service."),console.info(i.message),e({type:o,results:[],count:0}),void e({type:s,error:i.message});e({type:o,results:n,count:l,query:r}),e({type:c})}});t.ZP=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a:return{...e,fetching:!0};case s:return{...e,error:t.error,fetching:!1};case c:return{...e,fetching:!1};case o:return{...e,results:t.results,count:t.count,query:t.query,selectedIndex:-1};case n:return{...e,selectedIndex:t.selectedIndex};default:return{...e}}}},42276:function(e,t,r){var o={"./cemetery--v15":[98938,938],"./cemetery--v15.jsx":[98938,938],"./cemetery--v16":[97841,841],"./cemetery--v16.jsx":[97841,841],"./faqs--v15":[81524,524],"./faqs--v15.jsx":[81524,524],"./faqs--v16":[20080,80],"./faqs--v16.jsx":[20080,80],"./organic":[44113,856,113],"./organic.jsx":[44113,856,113],"./people--v15":[62140,140],"./people--v15.jsx":[62140,140],"./people--v16":[12507,507],"./people--v16.jsx":[12507,507],"./planning_applications--v15":[53298,298],"./planning_applications--v15.jsx":[53298,298],"./planning_applications--v16":[38504,504],"./planning_applications--v16.jsx":[38504,504],"./programs--v15":[86588,588],"./programs--v15.jsx":[86588,588],"./programs--v16":[32723,723],"./programs--v16.jsx":[32723,723],"./roadworks--v15":[75554,554],"./roadworks--v15.jsx":[75554,554],"./roadworks--v16":[54563,563],"./roadworks--v16.jsx":[54563,563],"./services--v15":[91362,362],"./services--v15.jsx":[91362,362],"./services--v16 ":[45542,542],"./services--v16 .jsx":[45542,542]};function n(e){if(!r.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],n=t[0];return Promise.all(t.slice(1).map(r.e)).then((function(){return r(n)}))}n.keys=function(){return Object.keys(o)},n.id=42276,e.exports=n}}]);
//# sourceMappingURL=AutocompleteConcierge-704e81143f8dee95e9b8.js.map