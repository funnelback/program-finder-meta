"use strict";(self.webpackChunkPlug_and_Play_Template=self.webpackChunkPlug_and_Play_Template||[]).push([[906],{81348:function(e,t){t.Z=function(e){if(void 0===e||"number"!=typeof e)throw new Error("Please ensure that bytes is passed as a number");if(0===e)return"0 Bytes";const t=parseInt(Math.floor(Math.log(e)/Math.log(1024)),10);return"".concat(Math.round(e/1024**t,2)," ").concat(["Bytes","KB","MB","GB","TB"][t])}},37059:function(e,t,a){a.d(t,{Z:function(){return c}});a(33948);var l=a(67294);function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},n.apply(this,arguments)}function s(e){let{children:t,toggleIsCollapsed:a,isCollapsed:n,isCollapsible:s,id:c}=e;return s?l.createElement("button",{className:"collapsible-card__header",type:"button",onClick:a,"aria-expanded":!n,"aria-controls":"content-".concat(c)},t):l.createElement("div",{className:"collapsible-card__header"},t)}function c(e){const{wrapperClasses:t,contentClasses:a,children:c,id:r,headingIcon:o,isCollapsible:i,isInitialCollapsed:m,isScrollable:d,subTitle:u,title:p,...g}=e;let _="";r&&(_="ComponentCard-".concat(r));let f=m||!1;_&&(f="collapsed"===localStorage.getItem(_));const[E,b]=(0,l.useState)(f),h=["collapsible-card","no-wysiwyg",t].join(" "),v=["collapsible-card__contents",a,d&&"collapsible-card--scrollable"].join(" "),N=["svg-icon",!1===E&&"collapsible-card__collapsed"].join(" "),y=(0,l.useCallback)((()=>{b(!E),_&&localStorage.setItem(_,E?"":"collapsed")}),[_,E]);return l.createElement("div",n({className:h,id:r},g),l.createElement(s,{isCollapsible:i,toggleIsCollapsed:y,isCollapsed:E,id:r},l.createElement("h2",{className:"collapsible-card__header-text"},p),(u||i||o)&&l.createElement("div",{className:"collapsible-card__header-right"},u&&l.createElement("h3",{className:"collapsible-card__header-text collapsible-card__header-text--sub-title"},u),i&&l.createElement("svg",{className:"".concat(N," collapsible-card__more-menu-icon")},l.createElement("title",null,E?"Expand panel":"Collapse panel"),l.createElement("use",{href:"#chevron"})),o)),(!0!==i||!0===i&&!1===E)&&l.createElement("div",{className:v,id:"content-".concat(r),role:"region",tabIndex:-1},c))}},5662:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});a(33948);var l=a(67294),n=a(45697),s=a.n(n),c=a(87553),r=a(81348),o=a(37059),i=a(21889);function m(e){let{children:t,className:a}=e;return l.createElement("div",{className:"personal-document-listing-message ".concat(a)},l.createElement("div",{className:"personal-document-listing-message__body"},l.createElement("div",{className:"personal-document-listing-message__icon"},l.createElement("svg",{className:"svg-icon svg-icon--xlarge personal-document-listing-message__icon-file"},l.createElement("use",{href:"#file-anyfile"})),l.createElement("svg",{className:"svg-icon personal-document-listing-message__icon-block"},l.createElement("use",{href:"#error"}))),l.createElement("div",{className:"personal-document-listing-message__content"},t)))}function d(e){let{document:t}=e;const{customIcon:a,customIconLabel:n,fileType:s}=t;let c="",r="file-type=default";if(s)switch(s){case"doc":case"docx":case"document":c="Document",r="file-type=docs";break;case"xls":case"xlsx":case"spreadsheet":c="Spreadsheet",r="file-type=sheets";break;case"ppt":case"pptx":case"presentation":c="Presentation",r="file-type=presentations";break;case"pdf":c="PDF",r="file-type=pdf";break;default:c=s}return a?l.createElement("img",{src:a,alt:n||c,className:"personal-document-listing-item__icon-image"}):l.createElement("svg",{"aria-label":c,className:"svg-icon svg-icon--small"},l.createElement("use",{href:"#".concat(r)}))}function u(e){let{title:t,numberOfDocuments:a,allDocumentsLabel:n,allDocumentsLinkOverride:s}=e;const{isLoading:u,isAuthNeeded:p,signInLink:g,isReady:_,error:f,documents:E,getDocuments:b,allDocumentsLink:h}=(0,l.useContext)(i.Z);(0,l.useEffect)((()=>{_&&b({count:a})}),[_,a]);let v,N="";return f&&(f===i.V.AUTH_ERROR?(N="auth",v=l.createElement("span",{className:"personal-document-listing-error__message"},"An error has occurred in authenticating your user account.")):f===i.V.POPUP_ERROR?(N="popup",v=l.createElement("span",{className:"personal-document-listing-error"},"An error has occurred in opening the authentication popup. Ensure popups are allowed and you are not closing the popup window.")):f===i.V.SCOPE_ERROR?(N="scope",v=l.createElement("span",{className:"personal-document-listing-error"},"An error has occurred loading your recent documents, ensure you have approved the required")):f===i.V.ERROR&&(N="error",v=l.createElement("span",{className:"personal-document-listing-error"},"An error has occurred loading your recent documents."))),l.createElement(o.Z,{id:"personalDocumentListing",isCollapsible:!0,title:t,contentClasses:"personal-document-listing"},u&&l.createElement("div",{className:"personal-document-listing-loading"},l.createElement("div",{className:"personal-document-listing-loading__label"},"Loading..."),[...Array(a)].map(((e,t)=>l.createElement("div",{key:t,className:"personal-document-listing-loading__shadow"})))),p&&l.createElement(m,{className:"personal-document-listing-sign-in"},l.createElement("div",{className:"personal-document-listing-sign-in__message"},l.createElement("div",{className:"personal-document-listing-sign-in__title"},"No files available"),g)),f&&l.createElement(m,{className:"personal-document-listing-error personal-document-listing-error--".concat(N)},v),_&&!p&&!u&&!f&&l.createElement(l.Fragment,null,l.createElement("ol",{className:"personal-document-listing__list"},E.map((e=>l.createElement("li",{key:e.id,className:"personal-document-listing-item"},l.createElement("div",{className:"personal-document-listing-item__icon"},l.createElement(d,{document:e})),l.createElement("a",{href:e.url,className:"personal-document-listing-item__title"},e.title),l.createElement("div",{className:"personal-document-listing-item__last-modified"},l.createElement("div",{className:"personal-document-listing-item__last-modified-date"},e.lastModifiedDate&&l.createElement(l.Fragment,null,l.createElement("span",{className:"sr-only"},"Modified on"),(0,c.Z)(e.lastModifiedDate,"d MMM yyyy"))),e.lastModifiedBy&&l.createElement("div",{className:"personal-document-listing-item__last-modified-by"},"Modified by"," ",e.lastModifiedBy)),l.createElement("div",{className:"personal-document-listing-item__size"},e.fileSize&&(0,r.Z)(e.fileSize),!e.fileSize&&l.createElement(l.Fragment,null,"â€“")))))),l.createElement("div",{className:"personal-document-listing__footer"},l.createElement("a",{href:s||h,target:"_blank",className:"personal-document-listing__all-documents",rel:"noreferrer"},l.createElement("svg",{"aria-label":"Opens in new window",className:"svg-icon svg-icon--small"},l.createElement("use",{href:"#external"})),n))))}u.propTypes={title:s().string,numberOfDocuments:s().number,allDocumentsLabel:s().string,allDocumentsLinkOverride:s().string},u.defaultProps={title:"Personal Document Listing",numberOfDocuments:5,allDocumentsLabel:"Check all documents on cloud",allDocumentsLinkOverride:""}}}]);
//# sourceMappingURL=PersonalDocumentListing-75bc8d61399bb09d1cb3.js.map